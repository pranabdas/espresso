"use strict";(self.webpackChunkespresso=self.webpackChunkespresso||[]).push([["8214"],{4562:function(s,e,a){a.r(e),a.d(e,{frontMatter:()=>c,toc:()=>h,default:()=>o,metadata:()=>n,assets:()=>m,contentTitle:()=>r});var n=JSON.parse('{"id":"hands-on/dos","title":"Density of States calculation","description":"Electronic density of states is an important property of a material.","source":"@site/docs/hands-on/dos.mdx","sourceDirName":"hands-on","slug":"/hands-on/dos","permalink":"/espresso/hands-on/dos","draft":false,"unlisted":false,"editUrl":"https://github.com/pranabdas/espresso/blob/main/docs/hands-on/dos.mdx","tags":[],"version":"current","frontMatter":{"title":"Density of States calculation","sidebar_label":"DOS calculation"},"sidebar":"docs","previous":{"title":"Structure optimization","permalink":"/espresso/hands-on/structure-optimization"},"next":{"title":"Bandstructure","permalink":"/espresso/hands-on/bands"}}'),t=a(5893),i=a(65),l=a(2834);let c={title:"Density of States calculation",sidebar_label:"DOS calculation"},r=void 0,m={},h=[];function d(s){let e={a:"a",admonition:"admonition",annotation:"annotation",code:"code",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msup:"msup",mtext:"mtext",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",...(0,i.a)(),...s.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.p,{children:"Electronic density of states is an important property of a material."}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"\u03C1"}),(0,t.jsx)(e.mo,{stretchy:"false",children:"("}),(0,t.jsx)(e.mi,{children:"E"}),(0,t.jsx)(e.mo,{stretchy:"false",children:")"}),(0,t.jsx)(e.mi,{children:"d"}),(0,t.jsx)(e.mi,{children:"E"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\rho(E)dE"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"\u03C1"}),(0,t.jsx)(e.span,{className:"mopen",children:"("}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,t.jsx)(e.span,{className:"mclose",children:")"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"})]})})]})," = number of electronic states in the energy interval ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mo,{stretchy:"false",children:"("}),(0,t.jsx)(e.mi,{children:"E"}),(0,t.jsx)(e.mo,{separator:"true",children:","}),(0,t.jsx)(e.mi,{children:"E"}),(0,t.jsx)(e.mo,{children:"+"}),(0,t.jsx)(e.mi,{children:"d"}),(0,t.jsx)(e.mi,{children:"E"}),(0,t.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"(E, E + dE)"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mopen",children:"("}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,t.jsx)(e.span,{className:"mpunct",children:","}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.jsx)(e.span,{className:"mbin",children:"+"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,t.jsx)(e.span,{className:"mclose",children:")"})]})]})]})]}),"\n",(0,t.jsx)(e.p,{children:"Before we can run the Density of States (DOS) calculation, we need"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["Perform fixed-ion self consistent filed (scf) calculation. In plane-wave\nbased DFT calculations the electronic density is expressed by functions of the\nform ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"exp"}),(0,t.jsx)(e.mo,{children:"\u2061"}),(0,t.jsx)(e.mo,{stretchy:"false",children:"("}),(0,t.jsx)(e.mi,{children:"i"}),(0,t.jsx)(e.mtext,{mathvariant:"bold",children:"k"}),(0,t.jsx)(e.mo,{children:"\u22C5"}),(0,t.jsx)(e.mtext,{mathvariant:"bold",children:"r"}),(0,t.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\exp (i \\textbf{k} \\cdot \\textbf{r})"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mop",children:"exp"}),(0,t.jsx)(e.span,{className:"mopen",children:"("}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"i"}),(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord textbf",children:"k"})}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.jsx)(e.span,{className:"mbin",children:"\u22C5"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(e.span,{className:"mord text",children:(0,t.jsx)(e.span,{className:"mord textbf",children:"r"})}),(0,t.jsx)(e.span,{className:"mclose",children:")"})]})]})]})," with energy given by\n",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsxs)(e.mrow,{children:[(0,t.jsx)(e.mi,{children:"E"}),(0,t.jsx)(e.mo,{children:"="}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{mathvariant:"normal",children:"\u210F"}),(0,t.jsx)(e.mn,{children:"2"})]}),(0,t.jsxs)(e.msup,{children:[(0,t.jsx)(e.mi,{children:"k"}),(0,t.jsx)(e.mn,{children:"2"})]}),(0,t.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,t.jsx)(e.mn,{children:"2"}),(0,t.jsx)(e.mi,{children:"m"})]}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"E = \\hbar^2k^2/2m"})]})})}),(0,t.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(e.span,{className:"mrel",children:"="}),(0,t.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"1.0641em",verticalAlign:"-0.25em"}}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord",children:"\u210F"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.8141em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,t.jsxs)(e.span,{className:"mord",children:[(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,t.jsx)(e.span,{className:"msupsub",children:(0,t.jsx)(e.span,{className:"vlist-t",children:(0,t.jsx)(e.span,{className:"vlist-r",children:(0,t.jsx)(e.span,{className:"vlist",style:{height:"0.8141em"},children:(0,t.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,t.jsx)(e.span,{className:"mord",children:"/2"}),(0,t.jsx)(e.span,{className:"mord mathnormal",children:"m"})]})]})]}),"."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["Perform non-self consistent field (nscf) calculation with denser k-point\ngrid. A large number of ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsx)(e.mrow,{children:(0,t.jsx)(e.mi,{children:"k"})}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"k"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"})]})})]})," points are required DOS calculation, as the accuracy\nof DOS depends on the integration in ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsx)(e.mrow,{children:(0,t.jsx)(e.mi,{children:"k"})}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"k"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"})]})})]})," space."]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["Finally, the DOS can be determined by integrating the electron density in ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsx)(e.mrow,{children:(0,t.jsx)(e.mi,{children:"k"})}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"k"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"})]})})]}),"\nspace."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["I have created a new input file (",(0,t.jsx)(e.code,{children:"pw.scf.silicon_dos.in"}),") which is very much the same as\nour previous scf input file except some parameters are modified. You can find\nall the input files in my ",(0,t.jsx)(e.a,{href:"https://github.com/pranabdas/espresso/",children:"GitHub repository"}),". We used the lattice constant value that\nwe obtained from the relaxation calculation. We should not directly use the\nexperimental/real lattice constant values. Depending on the method and\npseudo-potential, it might result stress in the system. We have increased the\n",(0,t.jsx)(e.code,{children:"ecutwfc"})," to have better precision. We run the scf calculation:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"pw.x < pw.scf.silicon_dos.in > pw.scf.silicon_dos.out\n"})}),"\n",(0,t.jsxs)(e.p,{children:["Next, we have prepared the input file for the ",(0,t.jsx)(e.code,{children:"nscf"})," calculation. Where is have\nadded ",(0,t.jsx)(e.code,{children:"occupations"})," in the ",(0,t.jsx)(e.code,{children:"&system"})," card as ",(0,t.jsx)(e.code,{children:"tetrahedra"})," (appropriate for DOS\ncalculation). We have increased the number of k-points to 12 \xd7 12 \xd7 12 with\nautomatic option. Also specify ",(0,t.jsx)(e.code,{children:"nosym = .TRUE."})," to avoid generation of\nadditional k-points in low symmetry cases. ",(0,t.jsx)(e.code,{children:"outdir"})," and ",(0,t.jsx)(e.code,{children:"prefix"})," must be the\nsame as in the ",(0,t.jsx)(e.code,{children:"scf"})," step, some of the inputs and output are read from previous\nstep. Here we can specify a larger number of ",(0,t.jsx)(e.code,{children:"nbnd"})," to calculate unoccupied\nbands. Number of occupied bands can be found in the ",(0,t.jsx)(e.code,{children:"scf"})," output as number of\nKohn-Sham states."]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"pw.x < pw.nscf.silicon_dos.in > pw.nscf.silicon_dos.out\n"})}),"\n",(0,t.jsx)(e.p,{children:"Now our final step is to calculate the density of states. The DOS input file as\nfollows:"}),"\n","\n",(0,t.jsx)(l.Z,{language:"bash",title:"src/silicon/pp.dos.silicon.in",showLineNumbers:!0,children:"&DOS\n  prefix='silicon',\n  outdir='./tmp/',\n  fildos='si_dos.dat',\n  emin=-9.0,\n  emax=16.0\n/\n"}),"\n",(0,t.jsx)(e.p,{children:"We run:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"dos.x < pp.dos.silicon.in > pp.dos.silicon.out\n"})}),"\n",(0,t.jsxs)(e.p,{children:["The DOS data in the ",(0,t.jsx)(e.code,{children:"si_dos.dat"})," file that we specified in our input file. We\ncan plot the DOS:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",metastring:'title="notebooks/silicon-dos.ipynb" showLineNumbers',children:"import matplotlib.pyplot as plt\nfrom matplotlib import rcParamsDefault\nimport numpy as np\n%matplotlib inline\n\n# load data\nenergy, dos, idos = np.loadtxt('../src/silicon/si_dos.dat', unpack=True)\n\n# make plot\nplt.figure(figsize = (12, 6))\nplt.plot(energy, dos, linewidth=0.75, color='red')\nplt.yticks([])\nplt.xlabel('Energy (eV)')\nplt.ylabel('DOS')\nplt.axvline(x=6.642, linewidth=0.5, color='k', linestyle=(0, (8, 10)))\nplt.xlim(-6, 16)\nplt.ylim(0, )\nplt.fill_between(energy, 0, dos, where=(energy < 6.642), facecolor='red', alpha=0.25)\nplt.text(6, 1.7, 'Fermi energy', fontsize= med, rotation=90)\nplt.show()\n"})}),"\n",(0,t.jsx)("img",{src:a(1225).Z,class:"inv-hue-rot-180",alt:"silicon-dos"}),"\n",(0,t.jsx)(e.admonition,{title:"Important",type:"info",children:(0,t.jsxs)(e.p,{children:["For a set of calculation, we must keep the ",(0,t.jsx)(e.code,{children:"prefix"})," same. For example, the\n",(0,t.jsx)(e.strong,{children:"nscf"})," or ",(0,t.jsx)(e.strong,{children:"bands"})," calculation uses the wavefunction calculated by the\n",(0,t.jsx)(e.strong,{children:"scf"})," calculation. When performing different calculations, for example you\nchange a parameter and want to see the changes, you must use different output\nfolder or unique ",(0,t.jsx)(e.code,{children:"prefix"})," for different calculations so that the outputs do not\nget mixed."]})}),"\n",(0,t.jsx)(e.admonition,{type:"tip",children:(0,t.jsxs)(e.p,{children:["Sometimes it is important to sample the ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsx)(e.mrow,{children:(0,t.jsx)(e.mi,{mathvariant:"normal",children:"\u0393"})}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Gamma"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord",children:"\u0393"})]})})]})," point for DOS calculation\n(e.g., the conducting bands cross the Fermi surface only at ",(0,t.jsxs)(e.span,{className:"katex",children:[(0,t.jsx)(e.span,{className:"katex-mathml",children:(0,t.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(e.semantics,{children:[(0,t.jsx)(e.mrow,{children:(0,t.jsx)(e.mi,{mathvariant:"normal",children:"\u0393"})}),(0,t.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Gamma"})]})})}),(0,t.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(e.span,{className:"base",children:[(0,t.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(e.span,{className:"mord",children:"\u0393"})]})})]})," point). In\nsuch cases, we need to use odd k-grid (e.g., 9\u27159\u27155)."]})})]})}function o(s={}){let{wrapper:e}={...(0,i.a)(),...s.components};return e?(0,t.jsx)(e,{...s,children:(0,t.jsx)(d,{...s})}):d(s)}},1225:function(s,e,a){a.d(e,{Z:()=>n});let n=a.p+"assets/images/silicon-dos-edf95503cd6527685b73ada318c5cf68.webp"}}]);