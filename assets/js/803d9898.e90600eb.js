"use strict";(self.webpackChunkespresso=self.webpackChunkespresso||[]).push([["3580"],{3584:function(n,e,t){t.r(e),t.d(e,{frontMatter:()=>r,toc:()=>d,default:()=>p,metadata:()=>a,assets:()=>c,contentTitle:()=>l});var a=JSON.parse('{"id":"hands-on/bands","title":"Bandstructure Calculation","description":"Before we can run bands calculation, we need to perform single-point [self","source":"@site/docs/hands-on/bands.mdx","sourceDirName":"hands-on","slug":"/hands-on/bands","permalink":"/espresso/hands-on/bands","draft":false,"unlisted":false,"editUrl":"https://github.com/pranabdas/espresso/blob/main/docs/hands-on/bands.mdx","tags":[],"version":"current","frontMatter":{"title":"Bandstructure Calculation","sidebar_label":"Bandstructure"},"sidebar":"docs","previous":{"title":"DOS calculation","permalink":"/espresso/hands-on/dos"},"next":{"title":"Al (metal)","permalink":"/espresso/hands-on/aluminum"}}'),s=t(5893),i=t(65),o=t(2834);let r={title:"Bandstructure Calculation",sidebar_label:"Bandstructure"},l=void 0,c={},d=[{value:"Note on bandgap",id:"note-on-bandgap",level:2},{value:"Resources",id:"resources",level:2}];function h(n){let e={a:"a",admonition:"admonition",annotation:"annotation",code:"code",em:"em",h2:"h2",li:"li",math:"math",mi:"mi",mrow:"mrow",ol:"ol",p:"p",pre:"pre",section:"section",semantics:"semantics",span:"span",strong:"strong",sup:"sup",ul:"ul",...(0,i.a)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.p,{children:["Before we can run ",(0,s.jsx)(e.code,{children:"bands"})," calculation, we need to perform single-point ",(0,s.jsx)(e.a,{href:"scf",children:"self\nconsistent field calculation"}),". We have our input ",(0,s.jsx)(e.code,{children:"scf"})," file with some new\nparameters:"]}),"\n","\n",(0,s.jsx)(o.Z,{language:"bash",title:"src/silicon/pw.scf.silicon_bands.in",showLineNumbers:!0,children:"&CONTROL\n  calculation = 'scf',\n  restart_mode = 'from_scratch',\n  prefix = 'silicon',\n  outdir = './tmp/'\n  pseudo_dir = '../pseudos/'\n  verbosity = 'high'\n/\n\n&SYSTEM\n  ibrav =  2,\n  celldm(1) = 10.2076,\n  nat =  2,\n  ntyp = 1,\n  ecutwfc = 50,\n  ecutrho = 400,\n  nbnd = 8,\n!  occupations = 'smearing',\n!  smearing = 'gaussian',\n!  degauss = 0.005\n/\n\n&ELECTRONS\n  conv_thr = 1e-8,\n  mixing_beta = 0.6\n/\n\nATOMIC_SPECIES\n  Si 28.086 Si.pz-vbc.UPF\n\nATOMIC_POSITIONS (alat)\n  Si 0.0 0.0 0.0\n  Si 0.25 0.25 0.25\n\nK_POINTS (automatic)\n  8 8 8 0 0 0\n"}),"\n",(0,s.jsxs)(e.p,{children:["Run the ",(0,s.jsx)(e.code,{children:"scf"})," calculation:"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"pw.x < pw.scf.silicon_bands.in > pw.scf.silicon_bands.out\n"})}),"\n",(0,s.jsxs)(e.p,{children:["Next step is our band calculation (non-self consistent field) calculation. The\n",(0,s.jsx)(e.code,{children:"bands"})," calculation is ",(0,s.jsx)(e.em,{children:"non self-consistent"})," and reads/uses the ground state\nelectron density, Hartree, exchange and correlation potentials obtained in the\nprevious step (scf calculation). In case of non self-consistent calculation, the\n",(0,s.jsx)(e.strong,{children:"pw.x"})," program determines the Kohn-Sham eigenfunction and eigenvalues without\nupdating Kohn-Sham Hamiltonian at every iteration. We need to specify the\nk-points for which we want to calculate the eigenvalues. You may use the\n",(0,s.jsx)(e.a,{href:"https://www.materialscloud.org/work/tools/seekpath",children:"See-K-path tool by materials cloud"})," to visualize the K-path. We\ncan specify ",(0,s.jsx)(e.code,{children:"nbnd"}),", by default it calculates half the number of valence\nelectrons, i.e., only the occupied ground state bands. Usually we are interested\nalso in the unoccupied bands above the Fermi energy. Number of occupied bands\ncan be found in the ",(0,s.jsx)(e.code,{children:"scf"})," output as number of Kohn-Sham states. Below is a\nsample input file for the band calculation:"]}),"\n","\n",(0,s.jsx)(o.Z,{language:"bash",title:"src/silicon/pw.bands.silicon.in",showLineNumbers:!0,children:"&control\n  calculation = 'bands',\n  restart_mode = 'from_scratch',\n  prefix = 'silicon',\n  outdir = './tmp/'\n  pseudo_dir = '../pseudos/'\n  verbosity = 'high'\n/\n\n&system\n  ibrav =  2,\n  celldm(1) = 10.2076,\n  nat =  2,\n  ntyp = 1,\n  ecutwfc = 50,\n  ecutrho = 400,\n  nbnd = 8\n /\n\n&electrons\n  conv_thr = 1e-8,\n  mixing_beta = 0.6\n /\n\nATOMIC_SPECIES\n  Si 28.086  Si.pz-vbc.UPF\n\nATOMIC_POSITIONS (alat)\n  Si 0.00 0.00 0.00\n  Si 0.25 0.25 0.25\n\nK_POINTS {crystal_b}\n5\n  0.0000 0.5000 0.0000 20  !L\n  0.0000 0.0000 0.0000 30  !G\n  -0.500 0.0000 -0.500 10  !X\n  -0.375 0.2500 -0.375 30  !U\n  0.0000 0.0000 0.0000 20  !G\n"}),"\n",(0,s.jsxs)(e.p,{children:["Run ",(0,s.jsx)(e.code,{children:"pw.x"})," with ",(0,s.jsx)(e.code,{children:"bands"})," calculation input file:"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"pw.x < pw.bands.silicon.in > pw.bands.silicon.out\n"})}),"\n",(0,s.jsxs)(e.p,{children:["After the bands calculation is performed, we need some postprocessing using\n",(0,s.jsx)(e.code,{children:"bands.x"})," utility in order to obtain the data in more usable format. Input file\nfor ",(0,s.jsx)(e.code,{children:"bands.x"})," postprocessing:"]}),"\n","\n",(0,s.jsx)(o.Z,{language:"bash",title:"src/silicon/pp.bands.silicon.in",showLineNumbers:!0,children:"&BANDS\n  prefix = 'silicon'\n  outdir = './tmp/'\n  filband = 'si_bands.dat'\n/\n"}),"\n",(0,s.jsxs)(e.p,{children:["Run ",(0,s.jsx)(e.code,{children:"bands.x"})," from post processing (PP) module:"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"bands.x < pp.bands.silicon.in > pp.bands.silicon.out\n"})}),"\n",(0,s.jsxs)(e.p,{children:["Finally, we run ",(0,s.jsx)(e.code,{children:"plotband.x"})," to visualize bandstructure. We can either run it\ninteractively (as described below) or provide an input file. In order to run\ninteractively, type ",(0,s.jsx)(e.code,{children:"plotband.x"})," in your terminal."]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"     Input file > si_bands.dat\nReading    8 bands at     91 k-points\nRange:   -5.8300   16.3420eV  Emin, Emax > -6, 16\nhigh-symmetry point:  0.5000 0.5000 0.5000   x coordinate   0.0000\nhigh-symmetry point:  0.0000 0.0000 0.0000   x coordinate   0.8660\nhigh-symmetry point:  1.0000 0.0000 0.0000   x coordinate   1.8660\nhigh-symmetry point:  1.0000 0.2500 0.2500   x coordinate   2.2196\nhigh-symmetry point:  0.0000 0.0000 0.0000   x coordinate   3.2802\noutput file (gnuplot/xmgr) > si_bands.gnuplot\nbands in gnuplot/xmgr format written to file si_bands.gnuplot\n\n\noutput file (ps) > si_bands.ps\nEfermi > 6.6416\ndeltaE, reference E (for tics) 4, 0\nbands in PostScript format written to file si_bands.ps\n"})}),"\n",(0,s.jsxs)(e.p,{children:["You will have ",(0,s.jsx)(e.code,{children:"si_bands.ps"})," with band diagram. Alternatively, you can use your\nfavorite plotting program to make the plots. Below is an example of using Python\nmatplotlib."]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:'title="notebooks/si-bands.ipynb" showLineNumbers',children:"import matplotlib.pyplot as plt\nfrom matplotlib import rcParamsDefault\nimport numpy as np\n%matplotlib inline\n\nplt.rcParams[\"figure.dpi\"]=150\nplt.rcParams[\"figure.facecolor\"]=\"white\"\nplt.rcParams[\"figure.figsize\"]=(8, 6)\n\n# load data\ndata = np.loadtxt('../src/silicon/si_bands.dat.gnu')\n\nk = np.unique(data[:, 0])\nbands = np.reshape(data[:, 1], (-1, len(k)))\n\nfor band in range(len(bands)):\n    plt.plot(k, bands[band, :], linewidth=1, alpha=0.5, color='k')\nplt.xlim(min(k), max(k))\n\n# Fermi energy\nplt.axhline(6.6416, linestyle=(0, (5, 5)), linewidth=0.75, color='k', alpha=0.5)\n# High symmetry k-points (check bands_pp.out)\nplt.axvline(0.8660, linewidth=0.75, color='k', alpha=0.5)\nplt.axvline(1.8660, linewidth=0.75, color='k', alpha=0.5)\nplt.axvline(2.2196, linewidth=0.75, color='k', alpha=0.5)\n# text labels\nplt.xticks(ticks= [0, 0.8660, 1.8660, 2.2196, 3.2802], \\\n           labels=['L', '$\\Gamma$', 'X', 'U', '$\\Gamma$'])\nplt.ylabel(\"Energy (eV)\")\nplt.text(2.3, 5.6, 'Fermi energy', fontsize= small)\nplt.show()\n"})}),"\n",(0,s.jsx)("img",{src:t(4063).Z,class:"inv-hue-rot-180",alt:"silicon-bands"}),"\n",(0,s.jsxs)(e.admonition,{type:"info",children:[(0,s.jsxs)(e.p,{children:["The ",(0,s.jsx)(e.code,{children:"k"})," values corresponding to high symmetry points (such as ",(0,s.jsxs)(e.span,{className:"katex",children:[(0,s.jsx)(e.span,{className:"katex-mathml",children:(0,s.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{mathvariant:"normal",children:"\u0393"})}),(0,s.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Gamma"})]})})}),(0,s.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,s.jsxs)(e.span,{className:"base",children:[(0,s.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,s.jsx)(e.span,{className:"mord",children:"\u0393"})]})})]}),", X, U, L)\nwhich we need to label in our band diagram, can be found in the post-processing\noutput file (",(0,s.jsx)(e.code,{children:"si_bands_pp.out"}),")."]}),(0,s.jsxs)(e.p,{children:["Bandgap value can be determined from the highest occupied, lowest unoccupied\nlevel values printed in ",(0,s.jsx)(e.code,{children:"scf"})," calculation output."]})]}),"\n",(0,s.jsx)(e.h2,{id:"note-on-bandgap",children:"Note on bandgap"}),"\n",(0,s.jsx)(e.p,{children:"Usually, band gaps computed using common exchange-correction functionals such as\nLDA or GGA are severely underestimated compared to actual experimental values.\nThis discrepancy is mainly due to (1) approximations used in the exchange\ncorrection functional and (2) a derivative discontinuity term, originating from\nthe density functional being discontinuous with the total number of electrons in\nthe system. The second contribution is larger contributor to the error. It can\nbe partly addressed by a variety of techniques such as the GW approximation."}),"\n",(0,s.jsxs)(e.p,{children:["Strategies to improve band gap prediction at moderate to low computational cost\nnow been developed by several groups, including Chan and Ceder (delta-sol)",(0,s.jsx)(e.sup,{children:(0,s.jsx)(e.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),",\nHeyd et al. (hybrid functionals)",(0,s.jsx)(e.sup,{children:(0,s.jsx)(e.a,{href:"#user-content-fn-2",id:"user-content-fnref-2","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})}),", and Setyawan et al. (empirical fits)",(0,s.jsx)(e.sup,{children:(0,s.jsx)(e.a,{href:"#user-content-fn-3",id:"user-content-fnref-3","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"3"})}),"."]}),"\n",(0,s.jsx)(e.h2,{id:"resources",children:"Resources"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://docs.materialsproject.org/methodology/materials-methodology/electronic-structure#accuracy-of-band-structures",children:"https://docs.materialsproject.org/methodology/materials-methodology/electronic-structure#accuracy-of-band-structures"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://www.materialscloud.org/work/tools/seekpath",children:"See K-pat online tool"})}),"\n"]}),"\n","\n",(0,s.jsxs)(e.section,{"data-footnotes":!0,className:"footnotes",children:[(0,s.jsx)(e.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{id:"user-content-fn-1",children:["\n",(0,s.jsxs)(e.p,{children:["M. Chan, G. Ceder, Efficient Band Gap Predictions for Solids, Physical\nReview Letters 19 (2010) ",(0,s.jsx)(e.a,{href:"https://doi.org/10.1103/PhysRevLett.105.196403",children:"https://doi.org/10.1103/PhysRevLett.105.196403"})," ",(0,s.jsx)(e.a,{href:"#user-content-fnref-1","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21A9"})]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{id:"user-content-fn-2",children:["\n",(0,s.jsxs)(e.p,{children:["J. Heyd, J.E. Peralta, G.E. Scuseria, R.L. Martin, Energy band gaps and\nlattice parameters evaluated with the Heyd-Scuseria-Ernzerhof screened hybrid\nfunctional, Journal of Chemical Physics 123 (2005)\n",(0,s.jsx)(e.a,{href:"https://doi.org/10.1063/1.2085170",children:"https://doi.org/10.1063/1.2085170"})," ",(0,s.jsx)(e.a,{href:"#user-content-fnref-2","data-footnote-backref":"","aria-label":"Back to reference 2",className:"data-footnote-backref",children:"\u21A9"})]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{id:"user-content-fn-3",children:["\n",(0,s.jsxs)(e.p,{children:["W. Setyawan, R.M. Gaume, S. Lam, R. Feigelson, S. Curtarolo,\nHigh-throughput combinatorial database of electronic band structures for\ninorganic scintillator materials., ACS Combinatorial Science. (2011)\n",(0,s.jsx)(e.a,{href:"https://doi.org/10.1021/co200012w",children:"https://doi.org/10.1021/co200012w"}),". ",(0,s.jsx)(e.a,{href:"#user-content-fnref-3","data-footnote-backref":"","aria-label":"Back to reference 3",className:"data-footnote-backref",children:"\u21A9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function p(n={}){let{wrapper:e}={...(0,i.a)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(h,{...n})}):h(n)}},4063:function(n,e,t){t.d(e,{Z:()=>a});let a=t.p+"assets/images/silicon-bands-a1a2786319101829eb5f78f018f412a4.webp"}}]);