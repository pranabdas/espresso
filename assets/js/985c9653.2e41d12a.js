"use strict";(self.webpackChunkespresso=self.webpackChunkespresso||[]).push([["6242"],{5774:function(s,e,a){a.r(e),a.d(e,{frontMatter:()=>c,toc:()=>m,default:()=>x,metadata:()=>n,assets:()=>h,contentTitle:()=>r});var n=JSON.parse('{"id":"hands-on/dft-u","title":"DFT+U calculation","description":"Electronic structure for transition metals (with localized $$d$$ or $$f$$","source":"@site/docs/hands-on/dft-u.mdx","sourceDirName":"hands-on","slug":"/hands-on/dft-u","permalink":"/espresso/hands-on/dft-u","draft":false,"unlisted":false,"editUrl":"https://github.com/pranabdas/espresso/blob/main/docs/hands-on/dft-u.mdx","tags":[],"version":"current","frontMatter":{"title":"DFT+U calculation","keywords":["DFT+U","Hubbard U calculation","DFT+U calculation in Quantum Espresso","LDA+U"]},"sidebar":"docs","previous":{"title":"Ni (spin pol. bands)","permalink":"/espresso/hands-on/ni"},"next":{"title":"Spin-Orbit Coupling","permalink":"/espresso/hands-on/soc"}}'),l=a(5893),i=a(65),t=a(2834);let c={title:"DFT+U calculation",keywords:["DFT+U","Hubbard U calculation","DFT+U calculation in Quantum Espresso","LDA+U"]},r=void 0,h={},m=[{value:"Changes to input syntax in v7.1",id:"changes-to-input-syntax-in-v71",level:2},{value:"DFT calculation for FeO",id:"dft-calculation-for-feo",level:2},{value:"Calculating Hubbard U",id:"calculating-hubbard-u",level:2},{value:"DFT+U calculation",id:"dftu-calculation",level:2},{value:"Resources",id:"resources",level:2}];function d(s){let e={a:"a",admonition:"admonition",annotation:"annotation",code:"code",h2:"h2",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",msup:"msup",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,i.a)(),...s.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(e.p,{children:["Electronic structure for transition metals (with localized ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"d"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"d"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",children:"d"})]})})]})," or ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"f"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"f"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"})]})})]}),"\nelectrons) is not accurately described by standard DFT, and therefore the need\nfor DFT+U formulation."]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-fortran",children:"&SYSTEM\n    ...\n    lda_plus_u = .TRUE.\n    Hubbard_u(i) = 2.0\n    ...\n/\n"})}),"\n",(0,l.jsxs)(e.p,{children:["Here ",(0,l.jsx)(e.code,{children:"i"})," refers to the atomic index in the ",(0,l.jsx)(e.code,{children:"&ATOMIC_SPECIES"})," card corresponding\nto each ",(0,l.jsx)(e.code,{children:"ntyp"}),". We can specify ",(0,l.jsx)(e.code,{children:"Hubbard_u(i)"})," corresponding to more than one\natom in separate lines."]}),"\n",(0,l.jsxs)(e.p,{children:["There is also ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"U"}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"e"}),(0,l.jsx)(e.mi,{children:"f"}),(0,l.jsx)(e.mi,{children:"f"})]})]}),(0,l.jsx)(e.mo,{children:"="}),(0,l.jsx)(e.mi,{children:"U"}),(0,l.jsx)(e.mo,{children:"\u2212"}),(0,l.jsx)(e.mi,{children:"J"})]}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"U_{eff} = U - J"})]})})}),(0,l.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.9694em",verticalAlign:"-0.2861em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.109em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"e"}),(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10764em"},children:"ff"})]})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200B"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(e.span,{className:"mrel",children:"="}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.7667em",verticalAlign:"-0.0833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.09618em"},children:"J"})]})]})]})," implementation in QE. ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"J"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"J"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.09618em"},children:"J"})]})})]})," represents on-site\nexchange interaction. Number of ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"J"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"J"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.09618em"},children:"J"})]})})]})," terms depends on the manifold of localized\nelectrons. For ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"p"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"p"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",children:"p"})]})})]}),", we have 1; for ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"d"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"d"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",children:"d"})]})})]}),", we have 2; and for ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"f"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"f"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"})]})})]}),", we have 3\nterms."]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-fortran",children:"    ...\n    lda_plus_u = .TRUE.\n    lda_plus_u_kind = 1\n    Hubbard_u(i) = U\n    Hubbard_J(k, i) = J_{ki}\n    ...\n"})}),"\n",(0,l.jsx)(e.admonition,{title:"COMMON ERRORS",type:"danger",children:(0,l.jsxs)(e.p,{children:["If you add ",(0,l.jsx)(e.code,{children:"Hubbard_u"})," for elements that is not implemented to have ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"U"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"U"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"})]})})]}),' term\nin QE, you might see a "pseudopotential not yet inserted" error.']})}),"\n",(0,l.jsx)(e.h2,{id:"changes-to-input-syntax-in-v71",children:"Changes to input syntax in v7.1"}),"\n",(0,l.jsxs)(e.p,{children:["Starting from Quantum Espresso version ",(0,l.jsx)(e.code,{children:"7.1"}),", there are changes to input syntax\nfor DFT+U calculations. In the new version, instead of defining the necessary\nDFT+U parameters, now there is a new Hubbard card."]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-diff",children:"&system\n...\n-  lda_plus_u = .true.,\n-  lda_plus_u_kind = 0,\n-  U_projection_type = 'atomic',\n-  Hubbard_U(1) = 4.6\n-  Hubbard_U(2) = 4.6\n...\n/\n\n+ HUBBARD (ortho-atomic)\n+ U Fe1-3d 4.6\n+ U Fe2-3d 4.6\n"})}),"\n",(0,l.jsxs)(e.p,{children:["Please refer to the ",(0,l.jsx)("a",{target:"_blank",href:a(1120).Z,children:"\nqe-x.x/Doc/Hubbard_input.pdf"})," for details."]}),"\n",(0,l.jsx)(e.h2,{id:"dft-calculation-for-feo",children:"DFT calculation for FeO"}),"\n",(0,l.jsx)(e.p,{children:"We will first perform the standard DFT calculation."}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsx)(e.li,{children:"Perform the SCF calculation:"}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"pw.x -in feo_scf.in > feo_scf.out\n"})}),"\n",(0,l.jsxs)(e.ol,{start:"2",children:["\n",(0,l.jsx)(e.li,{children:"Perform NSCF calculation with denser k-grid:"}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"pw.x -in feo_nscf.in > feo_nscf.out\n"})}),"\n",(0,l.jsxs)(e.ol,{start:"3",children:["\n",(0,l.jsx)(e.li,{children:"Perform P-DOS calculation:"}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"projwfc.x -in feo_projwfc.in > feo_projwfc.out\n"})}),"\n",(0,l.jsx)("img",{src:a(6603).Z,class:"inv-hue-rot-180",alt:"feo-pdos-dft"}),"\n",(0,l.jsx)(e.p,{children:"This gives us metallic density of states. In practice we get insulating FeO."}),"\n",(0,l.jsx)(e.h2,{id:"calculating-hubbard-u",children:"Calculating Hubbard U"}),"\n","\n",(0,l.jsx)(t.Z,{language:"bash",title:"src/FeO/feo_hp.in",showLineNumbers:!0,children:"&inputhp\n   prefix = 'FeO'\n   outdir = './tmp/'\n   nq1 = 1, nq2 = 1, nq3 = 1\n/\n"}),"\n",(0,l.jsxs)(e.p,{children:["Perform a linear-response calculation using ",(0,l.jsx)(e.code,{children:"hp.x"})," program:"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"hp.x -in feo_hp.in > feo_hp.out\n"})}),"\n",(0,l.jsxs)(e.p,{children:["Check the file ",(0,l.jsx)(e.code,{children:"FeO.Hubbard_parameters.dat"}),"."]}),"\n",(0,l.jsx)(e.admonition,{type:"info",children:(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsxs)(e.p,{children:["We need to check the convergence against q-mesh (as well as k-mesh in SCF\ncalculation). Here ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mn,{children:"1"}),(0,l.jsx)(e.mo,{children:"\xd7"}),(0,l.jsx)(e.mn,{children:"1"}),(0,l.jsx)(e.mo,{children:"\xd7"}),(0,l.jsx)(e.mn,{children:"1"})]}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"1\\times 1\\times 1"})]})})}),(0,l.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,l.jsx)(e.span,{className:"mord",children:"1"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"\xd7"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,l.jsx)(e.span,{className:"mord",children:"1"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"\xd7"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,l.jsx)(e.span,{className:"mord",children:"1"})]})]})]})," mesh is used. ",(0,l.jsx)(e.strong,{children:"Important:"})," ",(0,l.jsx)(e.code,{children:"lda_plus_u"}),"\nmust be set to ",(0,l.jsx)(e.code,{children:".true."})," during the SCF calculation, ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"U"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"U"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"})]})})]})," may be set to zero."]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsxs)(e.p,{children:["We can update the obtained ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"U"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"U"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"})]})})]})," value in our SCF calculation, and repeat\nlinear response calculation until we have reached self consistency in ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"U"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"U"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"})]})})]})," value."]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsxs)(e.p,{children:["To go even further one can check the convergence of geometry during ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"U"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"U"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"})]})})]}),"\nupdates."]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsxs)(e.p,{children:["There is also inter-site Hubbard correction DFT+U+V calculation. The results\ncould be more closer to hybrid functionals like GW. The ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"V"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"V"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"})]})})]})," can also be\ncalculated using Quantum Espresso ",(0,l.jsx)(e.strong,{children:"hp.x"})," code."]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsxs)(e.p,{children:["Obtained value of ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"U"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"U"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"})]})})]})," depends on pseudopotential, Hubbard manifold (whether\natomic, ortho-atomic etc.)."]}),"\n"]}),"\n"]})}),"\n",(0,l.jsx)(e.admonition,{type:"danger",children:(0,l.jsxs)(e.p,{children:["The above ",(0,l.jsx)(e.strong,{children:"hp.x"})," code is not suitable for closed cell systems (e.g., fully\noccupied d-shell element), in such cases this linear response method gives\nunrealistically large ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsx)(e.mi,{children:"U"})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"U"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"})]})})]})," value."]})}),"\n",(0,l.jsx)(e.h2,{id:"dftu-calculation",children:"DFT+U calculation"}),"\n",(0,l.jsxs)(e.p,{children:["We repeat the calculation after setting in the ",(0,l.jsx)(e.code,{children:"&SYSTEM"})," card:"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"Hubbard_U(1) = 4.6\nHubbard_U(2) = 4.6\n"})}),"\n",(0,l.jsx)(e.p,{children:"We repeat the above calculation and plot the results. Now we find insulating\nground state."}),"\n",(0,l.jsx)("img",{src:a(3869).Z,class:"inv-hue-rot-180",alt:"feo-pdos-dft-u"}),"\n",(0,l.jsxs)(e.admonition,{type:"info",children:[(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"U_projection_type = 'ortho-atomic'"})," might give more realistic result than the\ndefault 'atomic'."]}),(0,l.jsxs)(e.p,{children:["When performing ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"D"}),(0,l.jsx)(e.mi,{children:"F"}),(0,l.jsx)(e.mi,{children:"T"}),(0,l.jsx)(e.mo,{children:"+"}),(0,l.jsx)(e.mi,{children:"U"})]}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"DFT+U"})]})})}),(0,l.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.7667em",verticalAlign:"-0.0833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"D"}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"FT"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"+"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"})]})]})]})," calculation, the ground state might get stuck in a\n",(0,l.jsx)(e.strong,{children:"local minimum"}),", in such cases we need to provide ",(0,l.jsx)(e.code,{children:"starting_ns_eigenvalue"})," to\nhelp calculation reach desired/actual ground state. Please see ",(0,l.jsx)("a",{target:"_blank",href:a(7168).Z,children:"these slides"})," by\nDr. Iurii Timrov for a relevant example."]})]}),"\n",(0,l.jsx)(e.admonition,{type:"tip",children:(0,l.jsxs)(e.p,{children:["Here we have plotted the ",(0,l.jsx)(e.code,{children:"lpdos"})," (local density of states). If we want to know\nthe contribution of ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"d"}),(0,l.jsxs)(e.msup,{children:[(0,l.jsx)(e.mi,{children:"z"}),(0,l.jsx)(e.mn,{children:"2"})]})]}),(0,l.jsx)(e.mo,{separator:"true",children:","}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"d"}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"y"}),(0,l.jsx)(e.mi,{children:"z"})]})]}),(0,l.jsx)(e.mo,{separator:"true",children:","}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"d"}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsxs)(e.msup,{children:[(0,l.jsx)(e.mi,{children:"x"}),(0,l.jsx)(e.mn,{children:"2"})]}),(0,l.jsx)(e.mo,{children:"\u2212"}),(0,l.jsxs)(e.msup,{children:[(0,l.jsx)(e.mi,{children:"z"}),(0,l.jsx)(e.mn,{children:"2"})]})]})]})]}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"d_{z^2}, d_{yz}, d_{x^2-z^2}"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.9805em",verticalAlign:"-0.2861em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.5224em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.04398em"},children:"z"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsx)(e.span,{className:"vlist-t",children:(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.7463em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.786em",marginRight:"0.0714em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]})})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200B"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1776em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mpunct",children:","}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.04398em"},children:"yz"})})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200B"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mpunct",children:","}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.5224em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsx)(e.span,{className:"vlist-t",children:(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.7463em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.786em",marginRight:"0.0714em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,l.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.04398em"},children:"z"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsx)(e.span,{className:"vlist-t",children:(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.7463em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.786em",marginRight:"0.0714em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]})]})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200B"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.236em"},children:(0,l.jsx)(e.span,{})})})]})})]})]})})]})," ect., we can find them from\nthe ",(0,l.jsx)(e.code,{children:"pdos"})," columns. Also there arise important Lowdin charges information in the\n",(0,l.jsx)(e.code,{children:"feo_projwfc.out"})," file."]})}),"\n",(0,l.jsx)(e.h2,{id:"resources",children:"Resources"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://youtu.be/34mHl0Iw2_E",children:"Hands-on DFT+U by Iurii Timrov and Matteo Cococcioni"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://youtu.be/64JKOF5lh2U",children:"Hubbard parameter calculation"})}),"\n"]})]})}function x(s={}){let{wrapper:e}={...(0,i.a)(),...s.components};return e?(0,l.jsx)(e,{...s,children:(0,l.jsx)(d,{...s})}):d(s)}},1120:function(s,e,a){a.d(e,{Z:()=>n});let n=a.p+"assets/files/Hubbard_input-63017ccb804e1b466d256baa695b3730.pdf"},7168:function(s,e,a){a.d(e,{Z:()=>n});let n=a.p+"assets/files/dft+u-Iurii-Timrov-5f6cc931c153910b3ba506e9f5f1b9d5.pdf"},3869:function(s,e,a){a.d(e,{Z:()=>n});let n=a.p+"assets/images/feo-pdos-dft-u-fdfc57f36bbc5581362a80ebe5cbfd13.webp"},6603:function(s,e,a){a.d(e,{Z:()=>n});let n=a.p+"assets/images/feo-pdos-dft-fe155af55cbcf7fc4b13ad54fd26b627.webp"}}]);